# IPO / TPI from:
# https://psl.noaa.gov/data/timeseries/IPOTPI/
# Each TPI list is Jan 1970 - Jan 2019 monthly. (49*12 + 1 samples)
# Nino3.4 list is Jan 1970 - mid 2024

TPI_unfiltered_PSL_OLD = [0.376, 0.329, -0.006, -0.100, -0.404, -0.486, -0.874, -1.203, -1.108, -1.072, -1.144, -1.142, -1.398, -1.295, -1.174, -1.008, -1.072, -1.255, -1.308, -1.195, -0.994, -1.137, -1.087, -1.073, -0.492, -0.166, -0.151, 0.120, 0.069, 0.357, 0.543, 0.854, 0.805, 1.050, 1.101, 1.415, 1.121, 0.437, 0.062, -0.435, -0.712, -0.885, -1.023, -1.187, -1.321, -1.485, -1.669, -1.750, -1.674, -1.427, -0.964, -0.797, -0.841, -0.830, -0.665, -0.573, -0.789, -1.070, -0.924, -0.992, -0.845, -0.610, -0.940, -0.898, -1.233, -1.197, -1.084, -1.206, -1.517, -1.635, -1.506, -1.656, -1.597, -0.911, -0.757, -0.725, -0.424, -0.016, 0.330, 0.517, 0.545, 0.864, 0.776, 0.479, 0.654, 0.537, 0.228, -0.163, 0.063, 0.364, 0.388, 0.265, 0.258, 0.494, 0.596, 0.598, 0.660, 0.357, 0.286, -0.058, -0.140, -0.332, -0.459, -0.533, -0.395, -0.012, 0.098, 0.017, -0.021, -0.273, -0.191, 0.166, 0.341, 0.200, 0.160, 0.044, 0.349, 0.363, 0.436, 0.420, 0.478, 0.330, 0.223, 0.479, 0.580, 0.289, 0.215, 0.111, 0.101, 0.240, 0.317, 0.363, 0.076, -0.098, -0.112, -0.181, -0.193, -0.153, -0.266, -0.204, -0.012, 0.131, 0.232, 0.147, 0.115, 0.211, 0.208, 0.382, 0.441, 0.656, 0.762, 0.921, 1.415, 1.687, 1.545, 1.754, 1.852, 1.783, 1.620, 1.286, 1.259, 1.347, 1.219, 0.880, 0.261, -0.060, -0.270, 0.058, 0.107, 0.137, 0.103, -0.082, -0.290, -0.420, -0.379, -0.217, -0.185, -0.090, -0.423, -0.766, -0.692, -0.568, -0.633, -0.632, -0.571, -0.271, -0.228, -0.234, -0.267, -0.256, -0.254, -0.237, -0.293, -0.017, 0.156, 0.149, 0.008, 0.114, 0.464, 0.513, 0.515, 0.609, 1.008, 1.059, 0.825, 0.996, 1.145, 1.000, 1.094, 1.116, 1.461, 1.487, 1.628, 1.409, 1.193, 1.090, 0.657, 0.189, 0.251, -0.021, -0.427, -0.893, -1.062, -0.889, -0.870, -1.399, -1.290, -1.355, -1.476, -1.111, -0.957, -0.724, -0.673, -0.420, -0.340, -0.512, -0.534, -0.542, -0.620, -0.078, -0.050, -0.023, -0.202, 0.123, -0.037, -0.062, -0.031, 0.161, 0.044, -0.050, -0.202, -0.188, 0.054, 0.041, 0.053, -0.004, 0.187, 0.277, 0.454, 0.500, 0.639, 0.793, 0.901, 1.000, 1.058, 0.997, 0.981, 1.206, 1.429, 1.082, 0.726, 0.574, 0.511, 0.543, 0.402, 0.376, 0.514, 0.699, 0.770, 1.027, 1.161, 1.016, 0.676, 0.743, 0.761, 0.721, 0.667, 0.710, 0.468, 0.230, 0.258, 0.614, 0.654, 0.618, 0.401, 0.255, 0.320, 0.660, 0.657, 0.691, 0.810, 0.682, 0.606, 0.379, 0.351, 0.471, 0.333, -0.163, -0.192, -0.377, -0.568, -0.501, -0.343, -0.296, -0.147, -0.316, -0.127, -0.063, -0.208, -0.245, -0.171, -0.018, 0.067, -0.297, 0.087, -0.141, 0.018, 0.394, 0.792, 1.152, 1.306, 1.633, 1.749, 1.971, 2.031, 1.863, 1.963, 1.626, 1.253, 0.684, 0.345, -0.102, -0.466, -0.449, -0.755, -1.150, -1.083, -1.169, -1.281, -1.213, -1.133, -1.279, -1.099, -1.259, -1.042, -1.035, -1.222, -1.459, -1.443, -1.345, -1.340, -1.102, -0.860, -0.687, -0.932, -0.902, -0.876, -0.815, -0.679, -0.797, -0.689, -0.634, -0.468, -0.597, -0.385, -0.501, -0.516, -0.530, -0.591, -0.321, -0.468, -0.606, -0.749, -0.716, -0.399, -0.459, -0.234, -0.087, -0.006, 0.139, 0.130, 0.347, 0.328, 0.674, 1.073, 1.048, 0.724, 0.674, 0.550, 0.049, -0.374, -0.334, 0.124, 0.261, -0.076, 0.353, 0.463, 0.278, 0.104, -0.007, 0.079, 0.060, -0.228, -0.246, -0.167, 0.084, 0.244, 0.239, 0.336, 0.577, 0.549, 0.035, 0.225, 0.145, 0.175, -0.025, -0.228, -0.283, -0.545, -0.780, -1.087, -0.786, -0.565, -0.457, -0.498, -0.418, -0.206, 0.020, 0.157, 0.318, 0.362, 0.716, 0.806, 1.065, 0.738, 0.265, -0.016, -0.028, -0.318, -0.244, -0.267, -0.555, -0.976, -1.312, -1.333, -1.250, -1.463, -1.401, -1.146, -1.039, -0.747, -0.668, -0.475, -0.307, -0.487, -0.604, -0.718, -0.956, -0.971, -0.936, -0.855, -0.404, -0.025, 0.293, 0.297, 0.345, 0.587, 0.710, 0.922, 1.077, 0.905, 0.658, 0.335, 0.249, -0.096, -0.624, -1.184, -1.447, -1.802, -1.757, -1.577, -1.653, -1.590, -1.241, -1.100, -0.800, -0.829, -0.870, -0.980, -1.009, -1.050, -1.290, -1.419, -1.258, -0.844, -0.556, -0.570, -0.292, -0.430, -0.059, -0.134, -0.035, -0.219, -0.001, 0.223, -0.227, -0.424, -0.449, -0.444, -0.409, -0.536, -0.687, -0.870, -0.910, -0.727, -0.581, -0.531, -0.511, -0.512, -0.428, -0.022, 0.055, 0.232, -0.072, -0.082, -0.187, -0.049, 0.376, 0.656, 0.752, 0.508, 0.494, 0.295, 0.536, 0.526, 0.807, 0.935, 1.156, 1.524, 1.538, 1.597, 1.595, 1.547, 1.158, 1.103, 0.759, 0.289, 0.048, -0.284, -0.382, -0.646, -0.830, -0.466, -0.222, -0.136, 0.011, -0.045, 0.045, 0.017, -0.112, -0.328, -0.469, -0.604, -0.861, -0.949, -1.070, -1.025, -1.027, -1.069, -0.732, -0.638, -0.542, -0.287, -0.225, -0.147, -0.024, 0.004, 0.119, 0.016]

TPI_unfiltered_PSL = [0.376, 0.329, -0.006, -0.100, -0.404, -0.486, -0.874, -1.203, -1.108, -1.072, -1.144, -1.142, -1.398, -1.295, -1.174, -1.008, -1.072, -1.255, -1.308, -1.195, -0.994, -1.137, -1.087, -1.073, -0.492, -0.166, -0.151, 0.120, 0.069, 0.357, 0.543, 0.854, 0.805, 1.050, 1.101, 1.415, 1.121, 0.437, 0.062, -0.435, -0.712, -0.885, -1.023, -1.187, -1.321, -1.485, -1.669, -1.750, -1.674, -1.427, -0.964, -0.797, -0.841, -0.830, -0.665, -0.573, -0.789, -1.070, -0.924, -0.992, -0.845, -0.610, -0.940, -0.898, -1.233, -1.197, -1.084, -1.206, -1.517, -1.635, -1.506, -1.656, -1.597, -0.911, -0.757, -0.725, -0.424, -0.016, 0.330, 0.517, 0.545, 0.864, 0.776, 0.479, 0.654, 0.537, 0.228, -0.163, 0.063, 0.364, 0.388, 0.265, 0.258, 0.494, 0.596, 0.598, 0.660, 0.357, 0.286, -0.058, -0.140, -0.332, -0.459, -0.533, -0.395, -0.012, 0.098, 0.017, -0.021, -0.273, -0.191, 0.166, 0.341, 0.200, 0.160, 0.044, 0.349, 0.363, 0.436, 0.420, 0.478, 0.330, 0.223, 0.479, 0.580, 0.289, 0.215, 0.111, 0.101, 0.240, 0.317, 0.363, 0.076, -0.098, -0.112, -0.181, -0.193, -0.153, -0.266, -0.204, -0.012, 0.131, 0.232, 0.147, 0.115, 0.211, 0.208, 0.382, 0.441, 0.656, 0.762, 0.921, 1.415, 1.687, 1.545, 1.754, 1.852, 1.783, 1.620, 1.286, 1.259, 1.347, 1.219, 0.880, 0.261, -0.060, -0.270, 0.058, 0.107, 0.137, 0.103, -0.082, -0.290, -0.420, -0.379, -0.217, -0.185, -0.090, -0.423, -0.766, -0.692, -0.568, -0.633, -0.632, -0.571, -0.271, -0.228, -0.234, -0.267, -0.256, -0.254, -0.237, -0.293, -0.017, 0.156, 0.149, 0.008, 0.114, 0.464, 0.513, 0.515, 0.609, 1.008, 1.059, 0.825, 0.996, 1.145, 1.000, 1.094, 1.116, 1.461, 1.487, 1.628, 1.409, 1.193, 1.090, 0.657, 0.189, 0.251, -0.021, -0.427, -0.893, -1.062, -0.889, -0.870, -1.399, -1.290, -1.355, -1.476, -1.111, -0.957, -0.724, -0.673, -0.420, -0.340, -0.512, -0.534, -0.542, -0.620, -0.078, -0.050, -0.023, -0.202, 0.123, -0.037, -0.062, -0.031, 0.161, 0.044, -0.050, -0.202, -0.188, 0.054, 0.041, 0.053, -0.004, 0.187, 0.277, 0.454, 0.500, 0.639, 0.793, 0.901, 1.000, 1.058, 0.997, 0.981, 1.206, 1.429, 1.082, 0.726, 0.574, 0.511, 0.543, 0.402, 0.376, 0.514, 0.699, 0.770, 1.027, 1.161, 1.016, 0.676, 0.743, 0.761, 0.721, 0.667, 0.710, 0.468, 0.230, 0.258, 0.614, 0.654, 0.618, 0.401, 0.255, 0.320, 0.660, 0.657, 0.691, 0.810, 0.682, 0.606, 0.379, 0.351, 0.471, 0.333, -0.163, -0.192, -0.377, -0.568, -0.501, -0.343, -0.296, -0.147, -0.316, -0.127, -0.063, -0.208, -0.245, -0.171, -0.018, 0.067, -0.297, 0.087, -0.141, 0.018, 0.394, 0.792, 1.152, 1.306, 1.633, 1.749, 1.971, 2.031, 1.863, 1.963, 1.626, 1.253, 0.684, 0.345, -0.102, -0.466, -0.449, -0.755, -1.150, -1.083, -1.169, -1.281, -1.213, -1.133, -1.279, -1.099, -1.259, -1.042, -1.035, -1.222, -1.459, -1.443, -1.345, -1.340, -1.102, -0.860, -0.687, -0.932, -0.902, -0.876, -0.815, -0.679, -0.797, -0.689, -0.634, -0.468, -0.597, -0.385, -0.501, -0.516, -0.530, -0.591, -0.321, -0.468, -0.606, -0.749, -0.716, -0.399, -0.459, -0.234, -0.087, -0.006, 0.139, 0.130, 0.347, 0.328, 0.674, 1.073, 1.048, 0.724, 0.674, 0.550, 0.049, -0.374, -0.334, 0.124, 0.261, -0.076, 0.353, 0.463, 0.278, 0.104, -0.007, 0.079, 0.060, -0.228, -0.246, -0.167, 0.084, 0.244, 0.239, 0.336, 0.577, 0.549, 0.035, 0.225, 0.145, 0.175, -0.025, -0.228, -0.283, -0.545, -0.780, -1.087, -0.786, -0.565, -0.457, -0.498, -0.418, -0.206, 0.020, 0.157, 0.318, 0.362, 0.716, 0.806, 1.065, 0.738, 0.265, -0.016, -0.028, -0.318, -0.244, -0.267, -0.555, -0.976, -1.312, -1.333, -1.250, -1.463, -1.401, -1.146, -1.039, -0.747, -0.668, -0.475, -0.307, -0.487, -0.604, -0.718, -0.956, -0.971, -0.936, -0.855, -0.404, -0.025, 0.293, 0.297, 0.345, 0.587, 0.710, 0.922, 1.077, 0.905, 0.658, 0.335, 0.249, -0.096, -0.624, -1.184, -1.447, -1.802, -1.757, -1.577, -1.653, -1.590, -1.241, -1.100, -0.800, -0.829, -0.870, -0.980, -1.009, -1.050, -1.290, -1.419, -1.258, -0.844, -0.556, -0.570, -0.292, -0.430, -0.059, -0.134, -0.035, -0.219, -0.001, 0.223, -0.227, -0.424, -0.449, -0.444, -0.409, -0.536, -0.687, -0.870, -0.910, -0.727, -0.581, -0.531, -0.511, -0.512, -0.428, -0.022, 0.055, 0.232, -0.072, -0.082, -0.187, -0.049, 0.376, 0.656, 0.752, 0.508, 0.494, 0.295, 0.536, 0.526, 0.807, 0.935, 1.156, 1.524, 1.538, 1.597, 1.595, 1.547, 1.158, 1.103, 0.759, 0.289, 0.048, -0.284, -0.382, -0.646, -0.830, -0.466, -0.222, -0.136, 0.011, -0.045, 0.045, 0.017, -0.112, -0.328, -0.469, -0.604, -0.861, -0.949, -1.070, -1.025, -1.027, -1.069, -0.732, -0.638, -0.542, -0.287, -0.225, -0.147, -0.024, 0.004, 0.119, 0.019, -0.084, 0.019, 0.086, 0.119, -0.055, -0.171, -0.387, -0.368, -0.195, -0.037, -0.076, -0.157, -0.281, -0.330, -0.075, -0.428, -0.725, -0.856, -1.099, -1.358, -1.390, -1.625, -1.271, -1.264, -1.130, -0.991, -0.982, -1.002, -0.868, -0.899, -0.740, -1.052, -1.332, -1.595, -1.760, -1.487, -1.349, -1.304, -1.528, -1.668, -1.507, -1.735, -1.798, -1.945, -1.844, -1.739, -1.424, -1.046, -0.999, -0.722, -0.606, -0.289, -0.086, -0.039,  0.314,  0.356,  0.566,  0.729,  0.553, 0.516, 0.394, 0.130, 0.011, -0.513, -0.601, -0.726, -0.706, -1.016, -1.046]

TPI_filtered_PSL = [-0.248, -0.256, -0.264, -0.272, -0.280, -0.288, -0.297, -0.305, -0.313, -0.322, -0.330, -0.339, -0.347, -0.355, -0.364, -0.372, -0.380, -0.388, -0.396, -0.404, -0.411, -0.419, -0.426, -0.433, -0.440, -0.446, -0.453, -0.459, -0.465, -0.471, -0.476, -0.481, -0.486, -0.491, -0.495, -0.499, -0.502, -0.506, -0.509, -0.511, -0.514, -0.516, -0.517, -0.518, -0.519, -0.519, -0.519, -0.519, -0.518, -0.516, -0.514, -0.512, -0.509, -0.506, -0.502, -0.498, -0.493, -0.488, -0.483, -0.477, -0.470, -0.464, -0.456, -0.449, -0.441, -0.432, -0.424, -0.415, -0.405, -0.396, -0.386, -0.376, -0.365, -0.354, -0.344, -0.333, -0.321, -0.310, -0.298, -0.287, -0.275, -0.263, -0.251, -0.238, -0.226, -0.214, -0.201, -0.188, -0.176, -0.163, -0.150, -0.137, -0.124, -0.111, -0.098, -0.084, -0.071, -0.058, -0.045, -0.032, -0.019, -0.006, 0.007, 0.020, 0.033, 0.045, 0.058, 0.070, 0.082, 0.094, 0.105, 0.117, 0.128, 0.139, 0.149, 0.159, 0.169, 0.179, 0.188, 0.196, 0.205, 0.213, 0.220, 0.227, 0.234, 0.241, 0.247, 0.252, 0.258, 0.263, 0.268, 0.272, 0.276, 0.280, 0.284, 0.287, 0.290, 0.292, 0.295, 0.297, 0.299, 0.301, 0.303, 0.304, 0.306, 0.307, 0.308, 0.308, 0.309, 0.309, 0.310, 0.310, 0.310, 0.310, 0.310, 0.309, 0.309, 0.308, 0.307, 0.306, 0.305, 0.303, 0.301, 0.300, 0.298, 0.296, 0.293, 0.291, 0.288, 0.285, 0.282, 0.279, 0.275, 0.271, 0.268, 0.264, 0.259, 0.255, 0.251, 0.246, 0.241, 0.236, 0.231, 0.226, 0.221, 0.215, 0.210, 0.204, 0.199, 0.193, 0.187, 0.182, 0.176, 0.170, 0.165, 0.159, 0.154, 0.149, 0.143, 0.138, 0.133, 0.128, 0.123, 0.118, 0.114, 0.109, 0.105, 0.101, 0.097, 0.094, 0.091, 0.088, 0.085, 0.082, 0.080, 0.078, 0.077, 0.075, 0.075, 0.074, 0.074, 0.074, 0.074, 0.075, 0.076, 0.078, 0.080, 0.082, 0.084, 0.087, 0.091, 0.094, 0.098, 0.102, 0.107, 0.112, 0.117, 0.122, 0.128, 0.133, 0.139, 0.146, 0.152, 0.158, 0.165, 0.171, 0.178, 0.185, 0.192, 0.199, 0.206, 0.213, 0.220, 0.227, 0.234, 0.241, 0.249, 0.256, 0.263, 0.270, 0.277, 0.284, 0.291, 0.298, 0.305, 0.312, 0.319, 0.325, 0.332, 0.338, 0.345, 0.351, 0.357, 0.363, 0.368, 0.374, 0.379, 0.383, 0.388, 0.392, 0.396, 0.399, 0.402, 0.405, 0.407, 0.408, 0.410, 0.410, 0.411, 0.410, 0.409, 0.408, 0.406, 0.404, 0.401, 0.397, 0.393, 0.389, 0.384, 0.378, 0.371, 0.365, 0.357, 0.350, 0.341, 0.333, 0.323, 0.314, 0.304, 0.293, 0.282, 0.271, 0.260, 0.248, 0.235, 0.223, 0.210, 0.197, 0.184, 0.170, 0.157, 0.143, 0.129, 0.115, 0.101, 0.087, 0.073, 0.059, 0.045, 0.030, 0.016, 0.002, -0.012, -0.025, -0.039, -0.052, -0.066, -0.079, -0.091, -0.104, -0.116, -0.128, -0.140, -0.151, -0.162, -0.173, -0.183, -0.193, -0.202, -0.212, -0.220, -0.228, -0.236, -0.243, -0.250, -0.257, -0.263, -0.268, -0.273, -0.278, -0.282, -0.285, -0.288, -0.291, -0.293, -0.295, -0.296, -0.296, -0.297, -0.296, -0.296, -0.295, -0.293, -0.291, -0.289, -0.286, -0.282, -0.279, -0.275, -0.271, -0.266, -0.261, -0.256, -0.251, -0.246, -0.240, -0.234, -0.229, -0.223, -0.217, -0.211, -0.204, -0.198, -0.192, -0.186, -0.181, -0.175, -0.169, -0.164, -0.158, -0.153, -0.148, -0.143, -0.139, -0.134, -0.130, -0.126, -0.122, -0.119, -0.116, -0.113, -0.111, -0.109, -0.107, -0.106, -0.105, -0.104, -0.104, -0.105, -0.106, -0.107, -0.109, -0.111, -0.113, -0.116, -0.120, -0.124, -0.128, -0.132, -0.137, -0.142, -0.148, -0.154, -0.160, -0.166, -0.173, -0.180, -0.187, -0.194, -0.202, -0.209, -0.217, -0.225, -0.233, -0.241, -0.249, -0.257, -0.265, -0.273, -0.282, -0.290, -0.298, -0.306, -0.315, -0.323, -0.331, -0.339, -0.347, -0.355, -0.362, -0.370, -0.377, -0.385, -0.392, -0.399, -0.405, -0.412, -0.418, -0.424, -0.430, -0.435, -0.441, -0.445, -0.450, -0.454, -0.458, -0.462, -0.465, -0.468, -0.470, -0.472, -0.474, -0.475, -0.476, -0.476, -0.476, -0.475, -0.474, -0.473, -0.471, -0.469, -0.466, -0.463, -0.459, -0.455, -0.450, -0.445, -0.440, -0.434, -0.428, -0.421, -0.414, -0.407, -0.399, -0.391, -0.383, -0.375, -0.366, -0.357, -0.348, -0.339, -0.329, -0.319, -0.309, -0.299, -0.289, -0.279, -0.269, -0.258, -0.248, -0.237, -0.227, -0.217, -0.206, -0.196, -0.186, -0.177, -0.167, -0.157, -0.148, -0.139, -0.131, -0.122, -0.114, -0.106, -0.099, -0.092, -0.085, -0.078, -0.072, -0.067, -0.062, -0.057, -0.053, -0.049, -0.046, -0.043, -0.041, -0.040, -0.039, -0.038, -0.038, -0.039, -0.040, -0.042, -0.045, -0.048, -0.052, -0.056, -0.061, -0.067, -0.073, -0.080, -0.088, -0.096, -99.000, -99.000, -99.000, -99.000, -99.000, -99.000, -99.000, -99.000, -99.000, -99.000, -99.000, -99.000, -99.000, -99.000, -99.000, -99.000, -99.000, -99.000, -99.000, -99.000, -99.000, -99.000, -99.000, -99.000]

# https://legacy.bas.ac.uk/met/gjma/sam.html
SAM_Marshall = [0.76,1.27,-2.26,-1.57,0.24,0.72,-1.22,1.63,-2.02,-2.19,0.45,-0.72,-0.36,0.16,2.02,-1.24,-2.48,1.31,
0.68,-0.78,-1.83,-2.23,-0.50,-1.57,-1.44,-0.36,-2.05,-2.94,-0.09,0.42,-1.24,-1.89,-0.91,-1.48,1.39,-1.38,-0.94,1.39,
2.16,0.36,-1.94,-0.12,2.57,1.98,-1.15,-1.28,-0.54,2.17,1.18,1.82,2.81,0.05,0.42,0.08,-1.22,-4.02,1.84,-1.33,-2.24,-2.37,
-1.68,-1.22,-1.23,0.56,-3.33,-0.35,-2.42,-0.16,1.23,0.59,0.11,0.35,-1.17,1.02,-0.10,1.56,1.75,-0.01,0.60,0.30,1.67,1.19,
-2.88,-5.07,-3.22,0.04,-1.17,-1.36,-0.77,-2.09,-1.82,-0.41,2.69,0.21,-0.20,-0.95,1.50,-0.24,-0.99,0.64,-0.91,0.83,-2.13,
2.94,1.19,0.68,-0.96,-0.01,0.74,-0.90,1.51,-0.49,1.54,2.52,3.14,1.39,-0.02,0.54,-1.26,-1.88,0.01,-1.75,-2.58,-1.77,-0.51,
3.19,-1.68,-1.68,-2.56,0.45,-2.09,-0.10,0.84,1.76,-2.47,-3.52,0.88,0.38,-1.43,-1.99,-1.49,-0.39,2.34,2.21,-0.77,0.70,
4.28,2.89,-0.70,2.40,0.01,1.00,1.56,-2.14,-2.32,-2.21,-2.44,0.89,-0.71,-0.60,-0.68,0.38,1.63,0.09,-0.72,2.05,3.79,1.52,
-1.96,-1.74,-0.38,-0.23,-0.33,1.08,-0.21,-2.33,-0.16,1.06,0.34,-3.22,-2.38,-0.02,-0.08,0.95,0.38,-2.49,2.64,1.26,1.07,
0.57,2.28,1.90,0.37,-4.89,-1.26,-0.57,-2.19,-0.95,-0.02,1.68,2.72,-0.38,0.50,1.31,-2.51,-2.49,-1.11,-0.17,-0.34,0.18,
-0.26,1.79,-0.72,0.78,1.77,0.30,0.13,0.12,-2.01,2.11,-2.03,-3.06,0.64,-2.00,-2.70,-6.03,1.77,1.88,-0.02,1.14,0.20,0.00,
3.73,2.91,0.88,-1.21,-0.23,-0.16,0.69,-0.05,-0.23,1.95,0.80,-3.34,-3.35,-0.28,-1.82,0.12,2.08,-0.06,0.29,-0.20,1.50,
-1.69,1.07,-1.36,1.02,1.04,-1.56,-0.57,-2.52,1.30,-0.84,-1.23,0.17,-1.89,-1.10,0.53,-2.19,-3.13,-0.80,-0.40,1.06,0.70,
1.49,0.58,-2.17,0.77,-0.10,1.80,2.10,0.40,2.82,2.69,1.14,1.21,1.48,1.38,0.53,2.72,1.59,-0.75,-1.50,-2.33,-0.15,1.53,-1.22,
-0.47,-2.43,1.91,2.89,0.31,-1.12,0.74,2.64,-0.79,-4.26,-0.51,3.09,-0.69,0.17,1.93,0.55,-1.74,1.31,-0.28,1.90,-1.40,0.22,
-2.46,-3.50,2.79,-2.36,0.03,2.37,0.68,1.43,0.15,1.43,0.69,1.82,0.76,0.69,-1.78,-3.17,-0.89,2.65,0.57,-0.05,2.89,1.11,
1.31,2.13,2.66,0.74,-0.26,2.84,2.59,2.26,0.56,-1.39,2.44,2.51,-1.81,0.72,1.44,0.16,3.35,1.83,3.12,3.59,2.32,0.74,0.97,
1.90,-0.31,0.52,-1.22,-3.20,1.21,-1.32,-2.05,1.43,-2.70,-0.57,3.49,-1.75,-0.02,0.20,-0.15,1.46,1.36,2.54,1.16,2.22,2.80,
-4.42,1.60,-1.69,-0.43,-0.67,1.14,-2.18,-5.77,0.03,1.29,-0.52,-0.98,-0.07,2.21,1.04,-2.52,1.20,2.33,-0.99,0.12,-0.15,
-0.69,2.56,-3.33,0.74,1.20,-0.15,1.69,2.52,0.00,1.77,-0.59,-1.18,-1.02,1.07,1.59,-0.12,3.46,-0.45,-0.41,-0.50,0.50,0.39,
-0.11,0.66,-2.76,0.56,-1.85,1.66,-0.69,2.28,2.05,1.61,-2.64,-0.26,1.79,0.14,1.34,0.03,2.36,-0.77,-0.33,-1.02,-0.65,-2.67,
-0.28,-1.88,-0.86,0.03,2.80,2.56,1.09,0.63,-0.81,-0.66,3.00,0.23,0.60,0.46,2.21,1.03,1.01,2.02,0.94,0.50,-0.43,-0.14,
0.54,-0.13,-2.44,-0.78,1.47,-1.20,1.09,-0.40,-2.12,0.04,0.08,1.51,3.14,3.37,1.24,-0.33,3.19,3.88,0.25,0.48,0.87,-0.79,
1.62,1.37,0.72,-1.52,-0.73,-1.79,0.59,-1.41,3.43,3.08,-1.53,0.48,2.18,0.47,1.46,3.18,1.34,0.09,0.83,-0.84,-0.90,0.71,
2.84,2.31,-0.07,0.88,0.23,1.17,-3.25,-2.72,-1.39,1.07,0.77,-0.13,0.36,1.34,1.18,-1.62,-0.21,0.68,1.97,-1.62,1.32,0.35,
2.45,1.35,4.92,0.88,2.03,0.41,2.41,2.00,1.86,1.91,-0.66,1.46,0.72,3.13,1.35,4.36,1.06,-0.92,3.66,0.81,-1.28,2.46,-0.89,
-3.12,-1.52,-1.12,-1.09,-1.56,1.65,1.82,1.98,0.16,0.31,0.42,-0.64,3.18,1.44,2.72,1.02,-0.03,-1.66,0.01,-1.57,0.55,
-0.78,1.83,2.76,2.84,1.44,2.79]

# https://psl.noaa.gov/gcos_wgsp/Timeseries/Data/nino34.long.data
Nino34 = [27.13,27.12,27.52,27.95,27.87,27.38,26.25,25.92,25.97,26.08,25.81,25.47,
25.11,25.48,25.96,26.80,27.04,26.91,26.59,26.22,26.00,25.95,25.80,25.69,
26.00,26.55,27.00,27.98,28.19,28.35,28.06,28.18,27.94,28.50,28.53,28.78,
28.18,27.84,27.83,27.70,27.30,26.83,26.08,25.66,25.35,25.15,24.58,24.41,
24.56,25.26,25.82,26.77,27.07,26.99,26.58,26.56,26.40,25.98,25.70,25.73,
26.21,26.43,26.66,27.18,26.87,26.43,25.99,25.72,25.31,25.26,25.19,24.95,
24.78,25.71,26.58,27.35,27.37,27.69,27.38,27.18,27.32,27.59,27.54,27.23,
27.42,27.31,27.65,27.52,27.84,28.05,27.67,27.13,27.19,27.62,27.69,27.67,
27.30,27.27,27.32,27.40,27.37,27.23,26.75,26.26,26.15,26.39,26.50,26.66,
26.63,26.86,27.38,27.94,27.77,27.72,27.02,27.09,27.23,27.05,27.00,27.28,
27.13,27.09,27.35,27.97,28.00,28.05,27.25,26.65,26.63,26.63,26.75,26.94,
26.12,26.31,27.24,27.60,27.76,27.54,26.79,26.70,26.68,26.70,26.39,26.65,
26.54,26.64,27.24,28.01,28.51,28.61,27.86,27.80,28.14,28.73,28.72,28.92,
29.01,28.98,28.95,28.89,28.99,28.31,27.11,26.75,26.26,25.70,25.52,25.64,
25.78,26.23,26.78,27.17,27.22,26.79,26.82,26.47,26.40,25.90,25.48,25.05,
25.69,25.85,26.30,26.79,26.97,26.93,26.62,26.38,26.18,26.09,26.22,26.19,
25.79,26.12,26.75,27.36,27.39,27.61,27.38,27.11,27.34,27.63,27.70,27.56,
27.77,27.94,28.50,28.66,28.77,28.92,28.56,28.36,28.28,28.10,27.94,27.64,
27.27,27.11,27.54,27.28,26.82,26.23,25.69,25.43,25.42,24.65,24.48,24.60,
24.63,25.39,25.93,26.66,27.06,27.04,26.76,26.29,26.37,26.33,26.36,26.46,
26.60,27.12,27.46,28.03,28.19,27.69,27.37,27.05,26.87,26.86,26.73,26.90,
27.09,27.08,27.36,27.98,28.30,28.34,27.84,27.30,26.98,27.64,27.79,28.20,
28.19,28.39,28.76,29.18,29.13,28.22,27.50,26.73,26.61,26.39,26.51,26.63,
26.86,27.18,27.73,28.68,28.79,28.33,27.55,27.04,27.01,27.09,26.94,26.77,
26.61,26.60,27.19,27.80,28.00,27.96,27.38,27.40,27.15,27.63,27.79,27.80,
27.68,27.64,27.75,28.04,27.89,27.77,27.26,26.50,26.18,26.01,25.87,25.86,
25.93,26.10,26.78,27.43,27.46,27.57,27.08,26.58,26.41,26.46,26.35,26.16,
26.15,26.53,27.19,28.11,28.74,28.84,28.83,28.81,28.85,29.02,29.08,28.89,
29.00,28.84,28.75,28.67,28.55,27.30,26.49,26.04,25.93,25.54,25.43,25.08,
25.05,25.35,26.34,26.96,26.99,26.74,26.39,25.89,25.91,25.70,25.24,25.04,
24.79,25.23,26.00,26.97,27.07,26.93,26.65,26.52,26.36,26.18,25.91,25.67,
25.70,26.13,26.78,27.47,27.57,27.58,27.24,26.80,26.47,26.47,26.37,26.13,
26.44,26.76,27.36,27.91,28.07,28.37,27.80,27.57,27.57,27.89,28.06,28.00,
27.56,27.40,27.74,27.74,27.34,27.50,27.37,26.92,26.90,27.19,27.05,26.91,
26.84,26.93,27.16,27.83,27.96,27.82,27.64,27.54,27.42,27.46,27.27,27.30,
27.14,27.02,27.54,28.05,28.16,27.91,27.22,26.83,26.67,26.59,26.21,25.83,
25.60,26.05,26.53,27.47,27.76,27.78,27.25,27.25,27.38,27.49,27.64,27.69,
27.17,26.88,27.11,27.61,27.47,27.52,26.86,26.31,25.71,25.33,25.07,24.98,
24.79,25.07,26.09,26.88,27.22,27.24,27.19,26.83,26.47,26.43,26.29,25.69,
25.58,26.05,26.54,27.52,28.04,28.17,27.91,27.49,27.43,27.69,28.15,28.40,
28.00,27.94,28.33,28.33,27.72,27.07,26.34,25.55,25.19,25.08,25.08,24.95,
24.88,25.50,26.27,27.03,27.34,27.43,27.00,26.22,25.99,25.81,25.56,25.54,
25.65,26.15,26.78,27.48,27.69,27.82,27.66,27.54,27.19,26.96,26.98,26.45,
26.16,26.36,27.12,27.69,27.59,27.36,26.94,26.59,26.66,26.49,26.64,26.50,
26.16,26.31,27.19,28.05,28.32,28.16,27.36,27.02,27.12,27.22,27.54,27.36,
27.17,27.34,27.73,28.67,28.90,28.96,28.78,28.75,28.76,28.94,29.23,29.14,
29.14,28.87,28.86,28.82,28.32,27.75,26.97,26.40,26.29,25.99,26.02,26.07,
26.24,26.75,27.17,27.99,28.17,27.91,27.44,26.69,26.20,26.21,25.81,25.74,
25.72,26.03,26.53,27.41,27.75,27.81,27.49,26.93,27.05,27.57,27.65,27.56,
27.09,27.38,28.06,28.44,28.48,28.34,27.64,27.07,26.86,27.29,27.39,27.10,
27.22,27.25,27.62,28.26,27.74,27.48,27.18,26.46,26.09,25.54,25.64,25.61,
25.54,25.82,26.54,27.22,27.45,27.63,27.03,26.50,26.25,25.95,25.78,25.52,
25.81,26.08,26.42,26.86,26.84,26.92,26.67,25.92,25.70,25.74,25.89,25.73,
25.80,26.14,27.13,28.01,28.34,28.63,28.43,28.44,28.41,28.32,28.66,28.40,
28.29,28.24,28.36,28.70,28.27,-99.99,-99.99,-99.99,-99.99,-99.99,-99.99,-99.99]

#========================================================================================
#========================================================================================

import csv
import numpy as np
from PAS_tools import windowAv, detrend, demean

#========================================================================================


def getNino(t_start=None, t_end=None, returnTime=False):

	if returnTime:
		nT = len(Nino34)
		NinoTime = np.array([1970+i/12 for i in range(nT)])
		return np.array(Nino34[t_start:t_end]), NinoTime[t_start:t_end]
	
	return np.array(Nino34[t_start:t_end])
	
#==

def getIPO(t_start=14*12-1, t_end=-3, DETREND=True, nn=60, interceptFlag=1, returnTime=False):

	IPO = np.array(TPI_unfiltered_PSL)
	nT = len(IPO)
	IPO = IPO[t_start:t_end]
	
	if DETREND:
		IPO = detrend(IPO, None, interceptFlag=interceptFlag)
	
	IPO = windowAv(IPO, n=nn)

	if returnTime:
		IPOtime = np.array([1970+i/12 for i in range(nT)])
		IPOtime = IPOtime[t_start:t_end]
		IPOtime = windowAv(IPOtime, n=nn)
		return IPO, IPOtime
	
	return IPO
	
#==

def getSAM(SAM_t_start=14*12-1, SAM_t_end=-3, DETREND=True, nn=60):

	SAM = np.array(SAM_Marshall[SAM_t_start:SAM_t_end])
	
	if DETREND:
		SAM = detrend(SAM, None)
	
	SAM = windowAv(SAM, n=nn)

	return SAM
	
#==

def getASL(ASL_t_start=14*12-1, ASL_t_end=-3, DETREND=True, AV=True, nn=60, COL='actP'):
	
	# time,lon,lat,ActCenPres,SectorPres,RelCenPres
	COLS = {'lon':1, 'lat':2, 'actP':3, 'P':4, 'relP':5}
	COL = COLS[COL]
	
	with open('ASL.csv', newline='') as csvfile:

		start_date = '1970-01-01'
		end_date = '2023-01-01'
		n = -1
		ASL = []
		
		spamreader = csv.reader(csvfile, delimiter=',', quotechar='|')
		for row in spamreader:

			if len(row) > 0:
				if row[0] == start_date:
					n += 1
				if n == 0:
					ASL.append(float(row[COL]))
				if row[0] == end_date:
					n += 1
	
	ASL = np.array(ASL[ASL_t_start:ASL_t_end])
	
	if DETREND:
		ASL = detrend(ASL, None)
	
	ASL = windowAv(ASL, n=nn, av=AV)
		
	return ASL
	
#==

def getPASASL(fname='/home/michael/Documents/data/slopeCurrent/0_779_y1/EXFpress.npy', ASL_t_start=14*12-1, ASL_t_end=-3):

	ASL = np.min(np.load(fname), axis=(1,2))
	ASL = detrend(ASL, None)
	ASL = ptools.windowAv(data,n=nn)
	
	return ASL



